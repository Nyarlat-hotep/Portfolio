/* ── ScrollTracker ─────────────────────────────────────────────────────────── */
.scroll-tracker {
  position: relative;
  width: 28px;
  /* CSS fallback so the line is always visible. JS (ResizeObserver) overrides
     this with the scroll container's exact clientHeight almost immediately.
     Do NOT use height: 100% — the flex-start parent has no defined height
     so it would resolve to 0. */
  height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

/* ── Vertical line ─────────────────────────────────────────────────────────── */
.tracker-line {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 1px;
  background: rgba(var(--planet-color-rgb, 168, 85, 247), 0.25);
  pointer-events: none;
}

/* ── Gradient fades ────────────────────────────────────────────────────────── */
.tracker-fade {
  position: absolute;
  left: 0;
  width: 100%;
  height: 100px;
  pointer-events: none;
  z-index: 2;
}

.tracker-fade-top {
  top: 0;
  background: linear-gradient(to bottom, #06060a 0%, transparent 100%);
}

.tracker-fade-bottom {
  bottom: 0;
  background: linear-gradient(to top, #06060a 0%, transparent 100%);
}

/* ── Section dots ──────────────────────────────────────────────────────────── */
.tracker-dot {
  position: absolute;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: rgba(var(--planet-color-rgb, 168, 85, 247), 0.6);
  border: 1px solid var(--planet-color, #a855f7);
  box-shadow: 0 0 5px rgba(var(--planet-color-rgb, 168, 85, 247), 0.45);
  cursor: pointer;
  padding: 0;
  z-index: 3;
  outline: none;
  transition: box-shadow 0.2s ease;
}

/* Expanded invisible hit area */
.tracker-dot::before {
  content: '';
  position: absolute;
  inset: -10px;
  border-radius: 50%;
}

.tracker-dot:hover {
  box-shadow: 0 0 9px rgba(var(--planet-color-rgb, 168, 85, 247), 0.9);
  transform: translate(-50%, -50%) scale(1.3);
}

/* ── Dot state machine ─────────────────────────────────────────────────────── */

.tracker-dot[data-state="absorbing"] {
  animation: dotAbsorb 0.4s ease-in forwards;
  pointer-events: none;
}

.tracker-dot[data-state="absorbed"] {
  opacity: 0;
  transform: translate(-50%, -50%) scale(0);
  pointer-events: none;
}

.tracker-dot[data-state="withdrawing"] {
  animation: dotWithdraw 0.5s ease-out forwards;
  pointer-events: none;
}

/* Dim — stays faded after withdrawal */
.tracker-dot[data-state="dim"] {
  opacity: 0.2;
  box-shadow: none;
}

/* Absorb: gentle swell then quietly disappear */
@keyframes dotAbsorb {
  0%   { transform: translate(-50%, -50%) scale(1);   opacity: 0.7; }
  25%  { transform: translate(-50%, -50%) scale(1.4); opacity: 0.9; }
  100% { transform: translate(-50%, -50%) scale(0);   opacity: 0; }
}

/* Withdraw: fades back in quietly */
@keyframes dotWithdraw {
  0%   { transform: translate(-50%, -50%) scale(0);   opacity: 0; }
  55%  { transform: translate(-50%, -50%) scale(1.1); opacity: 0.3; }
  100% { transform: translate(-50%, -50%) scale(1);   opacity: 0.2; }
}

/* ── Amoeba ────────────────────────────────────────────────────────────────── */
.tracker-amoeba {
  position: absolute;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 11px;
  height: 11px;
  border-radius: 50%;
  background: radial-gradient(
    circle at 38% 32%,
    rgba(255, 255, 255, 0.6) 0%,
    var(--planet-color, #a855f7) 45%,
    rgba(var(--planet-color-rgb, 168, 85, 247), 0.4) 100%
  );
  box-shadow:
    0 0 8px rgba(var(--planet-color-rgb, 168, 85, 247), 0.9),
    0 0 18px rgba(var(--planet-color-rgb, 168, 85, 247), 0.4);
  z-index: 4;
  pointer-events: none;
  animation: amoebaPulse 3s ease-in-out infinite;
}

/* Gentle idle breathe */
@keyframes amoebaPulse {
  0%, 100% {
    transform: translate(-50%, -50%) scale(1);
    box-shadow:
      0 0 8px rgba(var(--planet-color-rgb, 168, 85, 247), 0.9),
      0 0 18px rgba(var(--planet-color-rgb, 168, 85, 247), 0.4);
  }
  50% {
    transform: translate(-50%, -50%) scale(1.12);
    box-shadow:
      0 0 11px rgba(var(--planet-color-rgb, 168, 85, 247), 1),
      0 0 24px rgba(var(--planet-color-rgb, 168, 85, 247), 0.5);
  }
}

/* Absorb: barely perceptible brightening — subtle, not jarring */
@keyframes amoebaAbsorb {
  0%   { transform: translate(-50%, -50%) scale(1);    filter: brightness(1); }
  20%  { transform: translate(-50%, -50%) scale(1.45); filter: brightness(1.4); }
  60%  { transform: translate(-50%, -50%) scale(1.1);  filter: brightness(1.1); }
  100% { transform: translate(-50%, -50%) scale(1);    filter: brightness(1); }
}

.tracker-amoeba.amoeba-absorb {
  animation: amoebaAbsorb 0.45s ease-out;
}
